lines <- c(lines, "## Education")
for (i in seq_along(data$education)) {
edu <- data$education[[i]]
eduTitle <- edu$degree
if (!nzchar(eduTitle)) {
eduTitle <- edu$school
}
eduLine <- paste0("**", eduTitle, "** â€” ", edu$school, " (", edu$years, ")")
lines <- c(lines, eduLine)
}
lines <- c(lines, "")
if (!is.null(data$certifications) && length(data$certifications) > 0) {
lines <- c(lines, "## Certifications")
for (c in data$certifications) {
lines <- c(lines, paste("- ", c))
}
lines <- c(lines, "")
}
if (!is.null(data$languages) && length(data$languages) > 0) {
lines <- c(lines, "## Languages")
languageLine <- collapseWithSep(data$languages, ", ")
lines <- c(lines, languageLine)
}
return(lines)
}
# 6. Build content and write plain text/markdown ---------------------------
atsLines <- buildAtsResume(resumeData)
prettyLines <- buildPrettyResume(resumeData)
atsTxtPath <- file.path(resumeDirPath, "kyleAtsResume.txt")
prettyMdPath <- file.path(resumeDirPath, "kylePrettyResume.md")
writeLines(atsLines, atsTxtPath)
cat("Wrote ATS text:", atsTxtPath, "\n")
writeLines(prettyLines, prettyMdPath)
cat("Wrote pretty markdown:", prettyMdPath, "\n")
# 7. Generate ATS DOCX -----------------------------------------------------
atsDocxPath <- file.path(resumeDirPath, "kyleAtsResume.docx")
makeDocxFromLines(atsLines, atsDocxPath)
# 8. Generate pretty DOCX from markdown -----------------------------------
prettyDocxPath <- file.path(resumeDirPath, "kylePrettyResume.docx")
render(
input = prettyMdPath,
output_format = "word_document",
output_file = prettyDocxPath
)
cat("Wrote pretty DOCX:", prettyDocxPath, "\n")
cat("Done.\n")
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
generateLandingPage <- function(indexPath, pageSlug, jsonPath, aboutMe = FALSE, addGallery = TRUE) {
if (!requireNamespace("jsonlite", quietly = TRUE)) {
stop("Please install jsonlite: install.packages('jsonlite')")
}
library(jsonlite)
# ----- read index.html -----
indexLines <- readLines(indexPath, warn = FALSE)
indexText  <- paste(indexLines, collapse = "\n")
# ----- robust Meet Grant section extraction -----
meetGrantMatch <- regexpr(
"<section id=\"meet-grant\"[\\s\\S]*?</section>",
indexText,
perl = TRUE
)
if (!aboutMe) {
# feature disabled for this page
meetGrantHtml <- ""
} else if (meetGrantMatch[1] == -1) {
# enabled, but section missing in index.html
meetGrantHtml <- ""
} else {
meetGrantHtml <- substr(
indexText,
meetGrantMatch[1],
meetGrantMatch[1] + attr(meetGrantMatch, "match.length") - 1
)
}
# ----- load config JSON -----
cfg <- jsonlite::fromJSON(jsonPath)
# ----- find structural markers in index.html -----
mainStart    <- regexpr("<main class=\"container\">", indexText) -2
footerStart  <- regexpr("<footer class=\"foot\">", indexText) - 2
contactStart <- regexpr("<section id=\"contact\"", indexText) - 2
mainEnd      <- regexpr("</main>", indexText)
if (mainStart == -1 || footerStart == -1 ||
contactStart == -1 || mainEnd == -1) {
stop("Could not find expected <main>, <footer>, or contact section markers in index.html")
}
# everything up to just before <main class="container">
headHtml    <- substr(indexText, 1, mainStart - 1)
# contact section (we'll reuse this as-is)
contactHtml <- substr(indexText, contactStart, mainEnd - 1)
# footer and closing tags
footerHtml  <- substr(indexText, footerStart, nchar(indexText))
# ----- update <title> and meta tags based on JSON -----
if (!is.null(cfg$seoTitle)) {
headHtml <- sub("(<title>)(.*?)(</title>)",
paste0("\\1", cfg$seoTitle, "\\3"),
headHtml)
headHtml <- sub(
'(<meta property="og:title" content=")[^"]*(" */*>)',
paste0("\\1", cfg$seoTitle, "\\2"),
headHtml
)
}
if (!is.null(cfg$metaDescription)) {
headHtml <- sub(
'(<meta name="description" content=")[^"]*(" */*>)',
paste0("\\1", cfg$metaDescription, "\\2"),
headHtml
)
headHtml <- sub(
'(<meta property="og:description" content=")[^"]*(" */*>)',
paste0("\\1", cfg$metaDescription, "\\2"),
headHtml
)
}
# ----- hero section -----
heroId <- if (!is.null(cfg$heroId)) cfg$heroId else pageSlug
# badges
badgesHtml <- ""
if (!is.null(cfg$badges) && length(cfg$badges) > 0) {
badgeLines <- paste0(
'          <span class="badge">',
cfg$badges,
"</span>"
)
badgesHtml <- paste(badgeLines, collapse = "\n")
}
primaryHref   <- cfg$primaryCtaHref
secondaryHref <- cfg$secondaryCtaHref
heroHtml <- paste0(
'<main class="container">', "\n",
'    <section class="hero" id="', heroId, '">', "\n",
"      <div>\n",
"        <h1>", cfg$heroHeading, "</h1>\n",
"        <p>", cfg$heroSubheading, "</p>\n",
"        <div class=\"cta-row\">\n",
"          <a class=\"cta\" href=\"", primaryHref,
"\" onclick=\"return gtag_report_conversion('", primaryHref, "');\">",
cfg$primaryCtaText, "</a>\n",
"          <a class=\"cta\" href=\"", secondaryHref,
"\" onclick=\"return gtag_report_conversion('", secondaryHref, "');\">",
cfg$secondaryCtaText, "</a>\n",
"        </div>\n",
"        <div class=\"badges\">\n",
badgesHtml, "\n",
"        </div>\n",
"      </div>\n",
"    </section>\n"
)
# ----- services section -----
servicesListHtml <- ""
if (!is.null(cfg$serviceBullets) && length(cfg$serviceBullets) > 0) {
li <- paste0("          <li>", cfg$serviceBullets, "</li>")
servicesListHtml <- paste(li, collapse = "\n")
}
servicesHtml <- paste0(
"    <section id=\"services\">\n",
"      <h2>", cfg$servicesHeading, "</h2>\n",
"      <div class=\"card\">\n",
"        <ul class=\"muted\" style=\"margin:.2rem 0 0 1rem; line-height:1.7\">\n",
servicesListHtml, "\n",
"        </ul>\n",
"      </div>\n",
"    </section>\n"
)
# ----- why section -----
whyListHtml <- ""
if (!is.null(cfg$whyBullets) && length(cfg$whyBullets) > 0) {
li <- paste0("        <li>", cfg$whyBullets, "</li>")
whyListHtml <- paste(li, collapse = "\n")
}
whyHtml <- paste0(
"    <section id=\"why\">\n",
"      <h2>", cfg$whyHeading, "</h2>\n",
"      <ul>\n",
whyListHtml, "\n",
"      </ul>\n",
"    </section>\n"
)
# ----- add gallery if option is TRUE -----
galleryHtml <- ""
if (addGallery) {
photosDir <- "photos"
pattern <- paste0(pageSlug, " \\(\\d+\\)\\.webp$")
photos <- list.files(photosDir, pattern = pattern, full.names = TRUE)
if (length(photos) > 0) {
galleryItems <- sapply(1:length(photos), function(i) {
caption <- paste("Image", i)  # Generic caption, tease it up if you want, baby
paste0('<div class="zoom-container">',
'<img src="', photos[i], '" alt="', caption, '" class="image" style="width: 100%; height: auto; display: block; transition: transform 0.3s;">',
'</div>')
})
galleryHtml <- paste0(
'<section id="gallery">',
'<h2>Gallery</h2>',
'<div class="random-gallery">',
paste(galleryItems, collapse = ""),
'</div>',
'</section>'
)
}
}
# ----- assemble new <main> -----
mainHtml <- paste0(
heroHtml, "\n",
meetGrantHtml, "\n",
servicesHtml, "\n",
whyHtml, "\n",
contactHtml, "\n",
"  </main>\n"
)
# ----- stitch everything back together -----
pageHtml <- paste0(headHtml, mainHtml, footerHtml)
outPath <- file.path(dirname(indexPath), paste0(pageSlug, ".html"))
writeLines(pageHtml, outPath, useBytes = TRUE)
invisible(outPath)
}
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
generateLandingPage <- function(indexPath, pageSlug, jsonPath, aboutMe = FALSE, addGallery = TRUE) {
if (!requireNamespace("jsonlite", quietly = TRUE)) {
stop("Please install jsonlite: install.packages('jsonlite')")
}
library(jsonlite)
# ----- read index.html -----
indexLines <- readLines(indexPath, warn = FALSE)
indexText  <- paste(indexLines, collapse = "\n")
# ----- robust Meet Grant section extraction -----
meetGrantMatch <- regexpr(
"<section id=\"meet-grant\"[\\s\\S]*?</section>",
indexText,
perl = TRUE
)
if (!aboutMe) {
# feature disabled for this page
meetGrantHtml <- ""
} else if (meetGrantMatch[1] == -1) {
# enabled, but section missing in index.html
meetGrantHtml <- ""
} else {
meetGrantHtml <- substr(
indexText,
meetGrantMatch[1],
meetGrantMatch[1] + attr(meetGrantMatch, "match.length") - 1
)
}
# ----- load config JSON -----
cfg <- jsonlite::fromJSON(jsonPath)
# ----- find structural markers in index.html -----
mainStart    <- regexpr("<main class=\"container\">", indexText) -2
footerStart  <- regexpr("<footer class=\"foot\">", indexText) - 2
contactStart <- regexpr("<section id=\"contact\"", indexText) - 2
mainEnd      <- regexpr("</main>", indexText)
if (mainStart == -1 || footerStart == -1 ||
contactStart == -1 || mainEnd == -1) {
stop("Could not find expected <main>, <footer>, or contact section markers in index.html")
}
# everything up to just before <main class="container">
headHtml    <- substr(indexText, 1, mainStart - 1)
# contact section (we'll reuse this as-is)
contactHtml <- substr(indexText, contactStart, mainEnd - 1)
# footer and closing tags
footerHtml  <- substr(indexText, footerStart, nchar(indexText))
# ----- update <title> and meta tags based on JSON -----
if (!is.null(cfg$seoTitle)) {
headHtml <- sub("(<title>)(.*?)(</title>)",
paste0("\\1", cfg$seoTitle, "\\3"),
headHtml)
headHtml <- sub(
'(<meta property="og:title" content=")[^"]*(" */*>)',
paste0("\\1", cfg$seoTitle, "\\2"),
headHtml
)
}
if (!is.null(cfg$metaDescription)) {
headHtml <- sub(
'(<meta name="description" content=")[^"]*(" */*>)',
paste0("\\1", cfg$metaDescription, "\\2"),
headHtml
)
headHtml <- sub(
'(<meta property="og:description" content=")[^"]*(" */*>)',
paste0("\\1", cfg$metaDescription, "\\2"),
headHtml
)
}
# ----- hero section -----
heroId <- if (!is.null(cfg$heroId)) cfg$heroId else pageSlug
# badges
badgesHtml <- ""
if (!is.null(cfg$badges) && length(cfg$badges) > 0) {
badgeLines <- paste0(
'          <span class="badge">',
cfg$badges,
"</span>"
)
badgesHtml <- paste(badgeLines, collapse = "\n")
}
primaryHref   <- cfg$primaryCtaHref
secondaryHref <- cfg$secondaryCtaHref
heroHtml <- paste0(
'<main class="container">', "\n",
'    <section class="hero" id="', heroId, '">', "\n",
"      <div>\n",
"        <h1>", cfg$heroHeading, "</h1>\n",
"        <p>", cfg$heroSubheading, "</p>\n",
"        <div class=\"cta-row\">\n",
"          <a class=\"cta\" href=\"", primaryHref,
"\" onclick=\"return gtag_report_conversion('", primaryHref, "');\">",
cfg$primaryCtaText, "</a>\n",
"          <a class=\"cta\" href=\"", secondaryHref,
"\" onclick=\"return gtag_report_conversion('", secondaryHref, "');\">",
cfg$secondaryCtaText, "</a>\n",
"        </div>\n",
"        <div class=\"badges\">\n",
badgesHtml, "\n",
"        </div>\n",
"      </div>\n",
"    </section>\n"
)
# ----- services section -----
servicesListHtml <- ""
if (!is.null(cfg$serviceBullets) && length(cfg$serviceBullets) > 0) {
li <- paste0("          <li>", cfg$serviceBullets, "</li>")
servicesListHtml <- paste(li, collapse = "\n")
}
servicesHtml <- paste0(
"    <section id=\"services\">\n",
"      <h2>", cfg$servicesHeading, "</h2>\n",
"      <div class=\"card\">\n",
"        <ul class=\"muted\" style=\"margin:.2rem 0 0 1rem; line-height:1.7\">\n",
servicesListHtml, "\n",
"        </ul>\n",
"      </div>\n",
"    </section>\n"
)
# ----- why section -----
whyListHtml <- ""
if (!is.null(cfg$whyBullets) && length(cfg$whyBullets) > 0) {
li <- paste0("        <li>", cfg$whyBullets, "</li>")
whyListHtml <- paste(li, collapse = "\n")
}
whyHtml <- paste0(
"    <section id=\"why\">\n",
"      <h2>", cfg$whyHeading, "</h2>\n",
"      <ul>\n",
whyListHtml, "\n",
"      </ul>\n",
"    </section>\n"
)
# ----- add gallery if option is TRUE -----
galleryHtml <- ""
if (addGallery) {
photosDir <- "photos"
pattern <- paste0(pageSlug, " \\(\\d+\\)\\.webp$")
photos <- list.files(photosDir, pattern = pattern, full.names = TRUE)
if (length(photos) > 0) {
galleryItems <- sapply(1:length(photos), function(i) {
caption <- paste("Image", i)  # Generic caption, tease it up if you want, baby
paste0('<div class="zoom-container">',
'<img src="', photos[i], '" alt="', caption, '" class="image" style="width: 100%; height: auto; display: block; transition: transform 0.3s;">',
'</div>')
})
galleryHtml <- paste0(
'<section id="gallery">',
'<h2>Gallery</h2>',
'<div class="random-gallery">',
paste(galleryItems, collapse = ""),
'</div>',
'</section>'
)
}
}
# ----- assemble new <main> -----
mainHtml <- paste0(
heroHtml, "\n",
meetGrantHtml, "\n",
servicesHtml, "\n",
whyHtml, "\n",
galleryHtml, "\n",
contactHtml, "\n",
"  </main>\n"
)
# ----- stitch everything back together -----
pageHtml <- paste0(headHtml, mainHtml, footerHtml)
outPath <- file.path(dirname(indexPath), paste0(pageSlug, ".html"))
writeLines(pageHtml, outPath, useBytes = TRUE)
invisible(outPath)
}
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
setwd("C:/HandyManGrant/handymanGrantWebsite")
source("buildLandingPage.R")  # if you save the function in this file
generateLandingPage(
indexPath = "index.html",
pageSlug  = "handyman-near-me",
jsonPath  = "handymanNearMe.json"
)
generateLandingPage("index.html", "drywall-repair", "drywallRepair.json")
generateLandingPage("index.html", "faucet-installation", "faucetInstallation.json")
generateLandingPage("index.html", "toilet-installation", "toiletInstallation.json")
generateLandingPage("index.html", "light-fixture-installation", "lightFixtureInstallation.json")
generateLandingPage("index.html", "ceiling-fan-installation", "ceilingFanInstallation.json")
generateLandingPage("index.html", "door-repair", "doorRepair.json")
generateLandingPage("index.html", "fence-repair", "fenceRepair.json")
generateLandingPage("index.html", "handyman-for-women-and-seniors", "handymanWomenSeniors.json", TRUE)
generateLandingPage("index.html", "senior-home-repairs", "seniorHomeRepairs.json", TRUE)
generateLandingPage("index.html", "aging-in-place-home-help", "agingInPlace.json", TRUE)
divs = paste0(front, picNames, back)
front = '<div class="zoom-container"><img src="photos/'
back = 'webp" alt="Big TV" class="image" style="width: 100%; height: auto; display: block; transition: transform 0.3s;">
</div>'
picNames = c("tv.", "tv2.", "ceilingBefore.")
divs = paste0(front, picNames, back)
divs
View(divs)
